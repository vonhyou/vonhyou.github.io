I"<p>WSL下安裝Rust有一點小坑，本文記錄一下</p>

<!--more-->

<h2 id="安裝rust">安裝Rust</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">--proto</span> <span class="s1">'=https'</span> <span class="nt">--tlsv1</span>.2 <span class="nt">-sSf</span> https://sh.rustup.rs | sh
</code></pre></div></div>

<p>基本上到這一步，安裝就已經完成了，但是我在新建項目的時候出了點小問題：</p>

<h2 id="解決錯誤-error-no-default-toolchain-configured">解決錯誤 <strong>error: no default toolchain configured</strong></h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rustup <span class="nb">install </span>stable
rustup default stable
</code></pre></div></div>

<p>到這裏，新建項目應該就沒問題了。</p>

<p>但是我還遇到一個小問題，，很討厭的小問題，，，</p>

<h2 id="解決錯誤-thread-main-panicked-at-assertion-failed-left--right">解決錯誤 <strong>thread ‘main’ panicked at ‘assertion failed: <code class="language-plaintext highlighter-rouge">(left == right)</code></strong></h2>

<p>唔，，，爲了解決這個問題花了我不少時間，，</p>

<p>問題是WSLv1造成的，也就是說最簡單的解決方案是升級WSL到WSL2</p>

<p>跟着微軟的<a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10#update-to-wsl-2">官方文檔</a>可以很快解決</p>

<p>但是人算不如天算，，我的windows 10死活沒法升級到2004，也就沒辦法安裝wsl2，這裏github上的一個<a href="https://github.com/rust-lang/rustup/issues/2245">issue</a>給出了另外兩個解決方案：一個是使用舊版本的linux——這個更麻煩，，另一個成功的解決了我的問題：</p>

<p>在bashrc（或者zshrc）裏加入：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">RUSTUP_IO_THREADS</span><span class="o">=</span>1
</code></pre></div></div>

<p>然後運行rustup問題迎刃而解，，，</p>

<p><img src="https://imgur.com/9uDuNnG.png" alt="" /></p>
:ET